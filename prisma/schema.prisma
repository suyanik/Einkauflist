datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

model User {
  id        String   @id @default(uuid())
  name      String
  phone     String   @unique
  pin       String
  role      Role     @default(STAFF)
  lists     ShoppingList[]
  createdAt DateTime @default(now())
}

enum Role {
  ADMIN
  STAFF
}

model Category {
  id       String   @id @default(uuid())
  name     String
  slug     String   @unique
  products Product[]
}

model Product {
  id          String   @id @default(uuid())
  categoryId  String
  category    Category @relation(fields: [categoryId], references: [id])
  name_tr     String
  name_de     String
  name_pa     String
  image       String?
  unit        String
  lastPrice   Decimal  @db.Decimal(10, 2) @default(0)
  listItems   ListItem[]
  createdAt   DateTime @default(now())
}

model ShoppingList {
  id        String     @id @default(uuid())
  status    ListStatus @default(PENDING)
  createdBy String
  creator   User       @relation(fields: [createdBy], references: [id])
  items     ListItem[]
  createdAt DateTime   @default(now())
}

enum ListStatus {
  PENDING
  COMPLETED
}

model ListItem {
  id             String       @id @default(uuid())
  shoppingListId String
  shoppingList   ShoppingList @relation(fields: [shoppingListId], references: [id])
  productId      String
  product        Product      @relation(fields: [productId], references: [id])
  quantity       Float
  price          Decimal?     @db.Decimal(10, 2)
}
