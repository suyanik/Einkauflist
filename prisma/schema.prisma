// prisma/schema.prisma

datasource db {
  provider = "postgresql" // Supabase, Neon veya yerel Postgres kullanabilirsiniz
}

generator client {
  provider = "prisma-client-js"
}

// Kullanıcılar (Admin ve Mutfak Personeli)
model User {
  id        String   @id @default(uuid())
  name      String
  phone     String   @unique // OTP giriş için telefon numarası
  pin       String   // 4 haneli PIN kodu
  role      Role     @default(STAFF) // ADMIN veya STAFF
  lists     ShoppingList[]
  createdAt DateTime @default(now())
}

enum Role {
  ADMIN
  STAFF
}

// Kategoriler (İçecek, Sebze, Metro, Genel)
model Category {
  id       String   @id @default(uuid())
  name     String   // Yönetici için (Örn: "İçecekler")
  slug     String   @unique // URL için (icecekler)
  products Product[]
}

// Ürünler (Çoklu Dil Destekli)
model Product {
  id          String   @id @default(uuid())
  categoryId  String
  category    Category @relation(fields: [categoryId], references: [id])
  
  // Çoklu Dil Alanları
  name_tr     String   // Türkçe: Domates
  name_de     String   // Almanca: Tomate
  name_pa     String   // Punjabi: ਟਮਾਟਰ (ਟਮਾਟਰ)
  
  image       String?  // Ürün fotoğrafı URL'si
  unit        String   // kg, paket, litre
  lastPrice   Decimal  @db.Decimal(10, 2) @default(0) // Raporlama için son Euro fiyatı
  
  listItems   ListItem[]
  createdAt   DateTime @default(now())
}

// Alışveriş Listeleri (Siparişler)
model ShoppingList {
  id        String     @id @default(uuid())
  status    ListStatus @default(PENDING) // PENDING (Hazırlanıyor), COMPLETED (Tamamlandı)
  createdBy String
  creator   User       @relation(fields: [createdBy], references: [id])
  
  items     ListItem[]
  createdAt DateTime   @default(now())
}

enum ListStatus {
  PENDING
  COMPLETED
}

// Liste Kalemleri (Ürün ve Miktar)
model ListItem {
  id             String       @id @default(uuid())
  shoppingListId String
  shoppingList   ShoppingList @relation(fields: [shoppingListId], references: [id])
  
  productId      String
  product        Product      @relation(fields: [productId], references: [id])
  
  quantity       Float        // Mutfak personeli girer (Örn: 2.5 kg)
  price          Decimal?     @db.Decimal(10, 2) // Siz marketten dönünce girersiniz (Örn: €3.50)
}
